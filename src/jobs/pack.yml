description: |
  Packs the orb source into a single "orb.yml" file and validates for orb config errors.

parameters:
  source-path:
    description: Path to the orb source. Path must be absolute or relative to the working directory.
    type: string
    default:

executor: default

steps:
  - run:
      name: Packing orb
      command: mkdir ./dist && circleci orb pack --skip-update-check <<parameters.source-path>> ./dist/orb.yml
  - run:
      name: Validating orb
      command: circleci orb validate --skip-update-check ./dist/orb.yml
  - persist_to_workspace:
      paths:
        - orb.yml
      root: ./dist