description: |
  Publish a full release of your orb. This job will automatically create a new git tag and Release on GitHub from the current HEAD of the default branch as well as publish your orb's source to the CircleCI Orb Registry.
  This job should only be ran when code is commited to your default branch. The config generated by the Orb Development Kit will default to "main" as the branch filter.
  This job requires a CircleCI Personal API Token for publishing the orb and a GitHub API token for creating tags and releases.

executor: cli/default

parameters:
  orb-name:
    type: string
    description: >
      The version-less orb slug, e.g. "circleci/orb-tools"
  circleci-token:
    description: |
      Enter the name of the environment variable containing your CircleCI API Token.
      This token must have production publishing scope (organization owner).
      Never directly enter the value of any secret tokens in your config.
    type: env_var_name
    default: CIRCLE_TOKEN
steps:
  - run:
      name: Publishing Orb Release
      environment:
        ORB_PARAM_ORB_PUB_TOKEN: <<parameters.circleci-token>>
        ORB_PARAM_ORB_NAME: <<parameters.orb-name>>
      command: <<include(scripts/publish-release.sh)>>
